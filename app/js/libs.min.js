let dropdown={handleEvent(t){let e=t.target.closest("[data-dropdown]");if(this.box&&!this.box.contains(e)&&this.isDropdown&&this.showDropdown(),!e)return;this.box=e,this.list=e.querySelector("[data-dropdown-list]");let s=e.querySelector("[data-dropdown-btn]");if(!this.list||!s)return;t.preventDefault(),t.target.closest("[data-dropdown-btn]")&&this.showDropdown();let i=t.target.closest("[data-dropdown-item]");i&&this.chooseDropdownItem(i,s)},chooseDropdownItem(t,e){let s=t.innerHTML,i=e.innerHTML;t.innerHTML=i,e.innerHTML=s,this.showDropdown()},showDropdown(){this.isDropdown=parseFloat(this.list.style.height)==this.list.scrollHeight,this.list.style.height=this.isDropdown?"":this.list.scrollHeight+"px",this.isDropdown=!this.isDropdown,this.list.dataset.dropdownList=this.isDropdown}},scrollLineWidth=window.innerWidth-document.documentElement.clientWidth;function menu(t,e){t.onclick=()=>{t.classList.toggle(e),document.body.classList.toggle(t.dataset.bodyClass),document.querySelector(".mobile__top").style.right=t.classList.contains(e)?scrollLineWidth+"px":""}}class Slider{constructor(t,{pointClassName:e,pointsElem:s,time:i,arrowLeft:n,arrowRight:r}){this.sliderLine=t.querySelector("[data-slider-line]"),this.sliderLine&&(this.sliderLine.style.cssText="transform: translateX(0px);",this.pointsElem=s,this.pointClassName=e||"pointClassName",this.pointNumber=0,this.interval,this.time=i,this.isPressed=!1,this.moveWithPressedMouse=this.moveWithPressedMouse.bind(this),parseInt(i)&&this.startTimer(),t.addEventListener("click",this.handleEvent.bind(this)),t.addEventListener("mousedown",this.handleEvent.bind(this)),t.addEventListener("mouseup",this.handleEvent.bind(this)),window.addEventListener("resize",this.reset.bind(this)))}handleEvent(t){let e=t.target.closest("[data-slider-point]");if(e&&"click"==t.type){if(e.classList.contains(this.pointClassName)||t.preventDefault(),e.dataset.sliderPoint-1==this.pointNumber)return;return this.time&&(this.stopTimer(),this.startTimer()),void this.changePoints(e.dataset.sliderPoint-1)}if(t.target.closest("[data-slider-line]"))switch(t.type){case"mousedown":this.startWithPressedMouse(t);break;case"dbclick":case"mouseup":this.endWithPressedMouse(t.clientX)}}moveSlider(t){let e=this.sliderLine.scrollWidth/this.sliderLine.children.length*t;this.sliderLine.style.transform=`translateX(-${e}px)`}changePoints(t){t=t<0?this.sliderLine.children.length-1:t>this.sliderLine.children.length-1?0:t,this.pointsElem&&(this.pointsElem.children[this.pointNumber].classList.remove(this.pointClassName),this.pointsElem.children[t].classList.add(this.pointClassName)),this.pointNumber=t,this.moveSlider(t)}startWithPressedMouse(t){this.isPressed=!0,this.startDistance=t.clientX,this.stopTimer(),this.initialSlide=t.target.closest("[data-slider-item]"),this.initialTransform=+getComputedStyle(this.sliderLine).transform.split(",")[4],this.sliderLine.style.transition="initial",window.addEventListener("mousemove",this.moveWithPressedMouse)}endWithPressedMouse(t){if(!this.isPressed)return;this.isPressed=!1,this.sliderLine.style.transition="";let e=t-this.startDistance;Math.abs(e)<.2*this.sliderLine.offsetWidth?this.sliderLine.style.transform=`translateX(${this.initialTransform}px)`:this.changePoints(e<0?this.pointNumber+1:this.pointNumber-1),window.removeEventListener("mousemove",this.moveWithPressedMouse),this.startTimer()}moveWithPressedMouse(t){let e=t.clientX-this.startDistance,s=this.initialTransform+e,i=-(this.sliderLine.scrollWidth-this.sliderLine.clientWidth);s=s>=0?0:s<=i?i:s,this.sliderLine.style.transform=`translateX(${s}px)`;let n=document.elementFromPoint(t.clientX,t.clientY);this.sliderLine.contains(n)||this.endWithPressedMouse(this.prevClientX),this.prevClientX=t.clientX,t.preventDefault()}startTimer(){this.interval=setInterval(()=>{console.log("setTimeout: "+this.timeout);let t=this.pointNumber+1;this.changePoints(t)},1e3*this.time)}stopTimer(){clearInterval(this.interval)}reset(){this.sliderLine.style.transform="translateX(0px)",this.changePoints(0)}}let submenu={handleEvent(t){(t.type="mouseover")&&this.setSubmenu(t.target),(t.type="mouseout")&&this.removeSubmenu(t.target)},setSubmenu(t){if(this.isSubmenu)return;if(this.menuItem=t.closest("[data-submenu]"),!this.menuItem)return;let e=this.menuItem.querySelector(".submenu");if(!e)return;let s=e.getBoundingClientRect(),i=document.documentElement.clientWidth-(s.left+e.offsetWidth);e.style.left=i<0?i-15+"px":"",this.isSubmenu=!0},removeSubmenu(t){this.isSubmenu&&this.menuItem.contains(t)&&(this.isSubmenu=!1)}};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLmpzIiwibWVudS5qcyIsInNsaWRlci5qcyIsInN1Ym1lbnUuanMiXSwibmFtZXMiOlsiZHJvcGRvd24iLCJbb2JqZWN0IE9iamVjdF0iLCJldmVudCIsImJveCIsInRhcmdldCIsImNsb3Nlc3QiLCJ0aGlzIiwiY29udGFpbnMiLCJpc0Ryb3Bkb3duIiwic2hvd0Ryb3Bkb3duIiwibGlzdCIsInF1ZXJ5U2VsZWN0b3IiLCJidG4iLCJwcmV2ZW50RGVmYXVsdCIsImVsZW0iLCJjaG9vc2VEcm9wZG93bkl0ZW0iLCJlbGVtQ2hpbGQiLCJpbm5lckhUTUwiLCJidG5DaGlsZCIsInBhcnNlRmxvYXQiLCJzdHlsZSIsImhlaWdodCIsInNjcm9sbEhlaWdodCIsImRhdGFzZXQiLCJkcm9wZG93bkxpc3QiLCJzY3JvbGxMaW5lV2lkdGgiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiZG9jdW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsIm1lbnUiLCJidG5DbGFzcyIsIm9uY2xpY2siLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJib2R5IiwiYm9keUNsYXNzIiwicmlnaHQiLCJTbGlkZXIiLCJzbGlkZXIiLCJwb2ludENsYXNzTmFtZSIsInBvaW50c0VsZW0iLCJ0aW1lIiwiYXJyb3dMZWZ0IiwiYXJyb3dSaWdodCIsInNsaWRlckxpbmUiLCJjc3NUZXh0IiwicG9pbnROdW1iZXIiLCJpbnRlcnZhbCIsImlzUHJlc3NlZCIsIm1vdmVXaXRoUHJlc3NlZE1vdXNlIiwiYmluZCIsInBhcnNlSW50Iiwic3RhcnRUaW1lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVFdmVudCIsInJlc2V0IiwicG9pbnQiLCJ0eXBlIiwic2xpZGVyUG9pbnQiLCJzdG9wVGltZXIiLCJjaGFuZ2VQb2ludHMiLCJzdGFydFdpdGhQcmVzc2VkTW91c2UiLCJlbmRXaXRoUHJlc3NlZE1vdXNlIiwiY2xpZW50WCIsImluZGV4IiwibGVmdCIsInNjcm9sbFdpZHRoIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJ0cmFuc2Zvcm0iLCJyZW1vdmUiLCJhZGQiLCJtb3ZlU2xpZGVyIiwic3RhcnREaXN0YW5jZSIsImluaXRpYWxTbGlkZSIsImluaXRpYWxUcmFuc2Zvcm0iLCJnZXRDb21wdXRlZFN0eWxlIiwic3BsaXQiLCJ0cmFuc2l0aW9uIiwiZGlmZk9mRGlzdGFuY2UiLCJNYXRoIiwiYWJzIiwib2Zmc2V0V2lkdGgiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2hpZnQiLCJtYXhTaGlmdCIsImN1cnJlbnRFbGVtIiwiZWxlbWVudEZyb21Qb2ludCIsImNsaWVudFkiLCJwcmV2Q2xpZW50WCIsInNldEludGVydmFsIiwiY29uc29sZSIsImxvZyIsInRpbWVvdXQiLCJjbGVhckludGVydmFsIiwic3VibWVudSIsInNldFN1Ym1lbnUiLCJyZW1vdmVTdWJtZW51IiwiaXNTdWJtZW51IiwibWVudUl0ZW0iLCJzdWJtZW51SXRlbSIsImNvb3JkcyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIm92ZXJFZGdlIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFBQSxTQUFBLENBQ0FDLFlBQUFDLEdBQ0EsSUFBQUMsRUFBQUQsRUFBQUUsT0FBQUMsUUFBQSxtQkFFQSxHQURBQyxLQUFBSCxNQUFBRyxLQUFBSCxJQUFBSSxTQUFBSixJQUFBRyxLQUFBRSxZQUFBRixLQUFBRyxnQkFDQU4sRUFBQSxPQUNBRyxLQUFBSCxJQUFBQSxFQUVBRyxLQUFBSSxLQUFBUCxFQUFBUSxjQUFBLHdCQUNBLElBQUFDLEVBQUFULEVBQUFRLGNBQUEsdUJBQ0EsSUFBQUwsS0FBQUksT0FBQUUsRUFBQSxPQUVBVixFQUFBVyxpQkFFQVgsRUFBQUUsT0FBQUMsUUFBQSx3QkFDQUMsS0FBQUcsZUFHQSxJQUFBSyxFQUFBWixFQUFBRSxPQUFBQyxRQUFBLHdCQUNBUyxHQUFBUixLQUFBUyxtQkFBQUQsRUFBQUYsSUFFQVgsbUJBQUFhLEVBQUFGLEdBQ0EsSUFBQUksRUFBQUYsRUFBQUcsVUFDQUMsRUFBQU4s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b0JBQUExRCxLQUFBcUYsYUFFQXJGLEtBQUFxRixZQUFBekYsRUFBQStELFFBRUEvRCxFQUFBVyxpQkFJQVosYUFDQUssS0FBQTJDLFNBQUEyQyxZQUFBLEtBQ0FDLFFBQUFDLElBQUEsZUFBQXhGLEtBQUF5RixTQUNBLElBQUE3QixFQUFBNUQsS0FBQTBDLFlBQUEsRUFDQTFDLEtBQUF3RCxhQUFBSSxJQUNBLElBQUE1RCxLQUFBcUMsTUFHQTFDLFlBQ0ErRixjQUFBMUYsS0FBQTJDLFVBR0FoRCxRQUNBSyxLQUFBd0MsV0FBQTFCLE1BQUFtRCxVQUFBLGtCQUNBakUsS0FBQXdELGFBQUEsSUM5SUEsSUFBQW1DLFFBQUEsQ0FFQWhHLFlBQUFDLElBQ0FBLEVBQUF5RCxLQUFBLGNBQUFyRCxLQUFBNEYsV0FBQWhHLEVBQUFFLFNBQ0FGLEVBQUF5RCxLQUFBLGFBQUFyRCxLQUFBNkYsY0FBQWpHLEVBQUFFLFNBR0FILFdBQUFhLEdBQ0EsR0FBQVIsS0FBQThGLFVBQUEsT0FHQSxHQURBOUYsS0FBQStGLFNBQUF2RixFQUFBVCxRQUFBLG1CQUNBQyxLQUFBK0YsU0FBQSxPQUVBLElBQUFDLEVBQUFoRyxLQUFBK0YsU0FBQTFGLGNBQUEsWUFDQSxJQUFBMkYsRUFBQSxPQUVBLElBQUFDLEVBQUFELEVBQUFFLHdCQUNBQyxFQUFBN0UsU0FBQUMsZ0JBQUFDLGFBQUF5RSxFQUFBcEMsS0FBQW1DLEVBQUFsQixhQUNBa0IsRUFBQWxGLE1BQUErQyxLQUFBc0MsRUFBQSxFQUFBQSxFQUFBLEdBQUEsS0FBQSxHQUVBbkcsS0FBQThGLFdBQUEsR0FHQW5HLGNBQUFhLEdBQ0FSLEtBQUE4RixXQUVBOUYsS0FBQStGLFNBQUE5RixTQUFBTyxLQUVBUixLQUFBOEYsV0FBQSIsImZpbGUiOiJsaWJzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBkcm9wZG93biA9IHtcclxuICAgIGhhbmRsZUV2ZW50KGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IGJveCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1kcm9wZG93bl0nKTtcclxuICAgICAgICBpZih0aGlzLmJveCAmJiAhdGhpcy5ib3guY29udGFpbnMoYm94KSAmJiB0aGlzLmlzRHJvcGRvd24pIHRoaXMuc2hvd0Ryb3Bkb3duKCk7XHJcbiAgICAgICAgaWYoIWJveCkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuYm94ID0gYm94O1xyXG5cclxuICAgICAgICB0aGlzLmxpc3QgPSBib3gucXVlcnlTZWxlY3RvcignW2RhdGEtZHJvcGRvd24tbGlzdF0nKTtcclxuICAgICAgICBsZXQgYnRuID0gYm94LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWRyb3Bkb3duLWJ0bl0nKTtcclxuICAgICAgICBpZighdGhpcy5saXN0IHx8ICFidG4pIHJldHVybjtcclxuXHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgaWYoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLWRyb3Bkb3duLWJ0bl0nKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dEcm9wZG93bigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGVsZW0gPSBldmVudC50YXJnZXQuY2xvc2VzdCgnW2RhdGEtZHJvcGRvd24taXRlbV0nKTtcclxuICAgICAgICBpZihlbGVtKSB0aGlzLmNob29zZURyb3Bkb3duSXRlbShlbGVtLCBidG4pO1xyXG4gICAgfSxcclxuICAgIGNob29zZURyb3Bkb3duSXRlbShlbGVtLCBidG4pIHtcclxuICAgICAgICBsZXQgZWxlbUNoaWxkID0gZWxlbS5pbm5lckhUTUw7XHJcbiAgICAgICAgbGV0IGJ0bkNoaWxkID0gYnRuLmlubmVySFRNTDtcclxuXHJcbiAgICAgICAgZWxlbS5pbm5lckhUTUwgPSBidG5DaGlsZDtcclxuICAgICAgICBidG4uaW5uZXJIVE1MID0gZWxlbUNoaWxkO1xyXG4gICAgICAgIHRoaXMuc2hvd0Ryb3Bkb3duKCk7XHJcbiAgICB9LFxyXG4gICAgc2hvd0Ryb3Bkb3duKCkge1xyXG4gICAgICAgIHRoaXMuaXNEcm9wZG93biA9IChwYXJzZUZsb2F0KHRoaXMubGlzdC5zdHlsZS5oZWlnaHQpID09IHRoaXMubGlzdC5zY3JvbGxIZWlnaHQpO1xyXG4gICAgICAgIHRoaXMubGlzdC5zdHlsZS5oZWlnaHQgPSAodGhpcy5pc0Ryb3Bkb3duKSA/ICcnIDogdGhpcy5saXN0LnNjcm9sbEhlaWdodCArICdweCc7XHJcbiAgICAgICAgdGhpcy5pc0Ryb3Bkb3duID0gIXRoaXMuaXNEcm9wZG93bjtcclxuICAgICAgICB0aGlzLmxpc3QuZGF0YXNldC5kcm9wZG93bkxpc3QgPSB0aGlzLmlzRHJvcGRvd247XHJcbiAgICB9XHJcbn0iLCJsZXQgc2Nyb2xsTGluZVdpZHRoID0gd2luZG93LmlubmVyV2lkdGggLSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7XHJcblxyXG5mdW5jdGlvbiBtZW51KGJ0biwgYnRuQ2xhc3MpIHtcclxuICAgIGJ0bi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZShidG5DbGFzcyk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZShidG4uZGF0YXNldC5ib2R5Q2xhc3MpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9iaWxlX190b3AnKS5zdHlsZS5yaWdodCA9IChidG4uY2xhc3NMaXN0LmNvbnRhaW5zKGJ0bkNsYXNzKSkgPyBcclxuICAgICAgICAgICAgc2Nyb2xsTGluZVdpZHRoICsgJ3B4J1xyXG4gICAgICAgICAgICA6ICcnOyBcclxuICAgIH1cclxufTsiLCJcclxuY2xhc3MgU2xpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKHNsaWRlciwge3BvaW50Q2xhc3NOYW1lLCBwb2ludHNFbGVtLCB0aW1lLCBhcnJvd0xlZnQsIGFycm93UmlnaHR9KSB7IC8vdGhlIHRpbWUgYXJndW1lbnQgdGFrZXMgYSBudW1iZXIgdmFsdWUgYXMgc2Vjb25kc1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZSA9IHNsaWRlci5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zbGlkZXItbGluZV0nKTtcclxuICAgICAgICBpZighdGhpcy5zbGlkZXJMaW5lKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS5jc3NUZXh0ID0gXCJ0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMHB4KTtcIlxyXG5cclxuICAgICAgICB0aGlzLnBvaW50c0VsZW0gPSBwb2ludHNFbGVtO1xyXG4gICAgICAgIHRoaXMucG9pbnRDbGFzc05hbWUgPSBwb2ludENsYXNzTmFtZSB8fCAncG9pbnRDbGFzc05hbWUnO1xyXG4gICAgICAgIHRoaXMucG9pbnROdW1iZXIgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmludGVydmFsO1xyXG4gICAgICAgIHRoaXMudGltZSA9IHRpbWU7XHJcblxyXG4gICAgICAgIHRoaXMuaXNQcmVzc2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5tb3ZlV2l0aFByZXNzZWRNb3VzZSA9IHRoaXMubW92ZVdpdGhQcmVzc2VkTW91c2UuYmluZCh0aGlzKTtcclxuXHJcbiAgICAgICAgaWYocGFyc2VJbnQodGltZSkpIHRoaXMuc3RhcnRUaW1lcigpOyBcclxuXHJcbiAgICAgICAgc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpKTtcclxuICAgICAgICBzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpKTtcclxuICAgICAgICBzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlRXZlbnQuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVzZXQuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlRXZlbnQoZXZlbnQpIHtcclxuXHJcbiAgICAgICAgbGV0IHBvaW50ID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLXNsaWRlci1wb2ludF0nKTtcclxuICAgICAgICBpZihwb2ludCAmJiBldmVudC50eXBlID09IFwiY2xpY2tcIikge1xyXG4gICAgICAgICAgICBpZighcG9pbnQuY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMucG9pbnRDbGFzc05hbWUpKSBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvL3ByZXZlbnQgdGhlIHByZXNzZWQgbGluayBnb2luZyBpZiBpdCBpcyB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgICAgICBpZihwb2ludC5kYXRhc2V0LnNsaWRlclBvaW50IC0gMSA9PSB0aGlzLnBvaW50TnVtYmVyKSByZXR1cm47IC8vaWYgdGhlIHByZXNzZWQgYnV0dG9uIGlzIHRoZSBzYW1lIG9uZSBsaWtlIGluIHRoZSBwcmV2aW91cyB0aW1lIHRoZW4gdG8gcmV0dXJuXHJcbiAgICAgICAgICAgIGlmKHRoaXMudGltZSkgeyAvLyBpZiB0aGUgcG9pbnQgaGF2ZSBwcmVzc2VkIHRoZW4gdG8gY2FuY2VsIHRoZSBjdXJyZW50IHRpbWVyIGFuZCBzdGFydCBpdCB1bnRpbGwgdGhlIHRyYW5zaXRpb24gZW5kIFxyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wVGltZXIoKTsgLy8gc3RvcCB0aGUgdGltZXIgYW55d2F5XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZVBvaW50cyhwb2ludC5kYXRhc2V0LnNsaWRlclBvaW50IC0gMSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1zbGlkZXItbGluZV0nKSkge1xyXG4gICAgICAgICAgICBzd2l0Y2goZXZlbnQudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2Vkb3duJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0V2l0aFByZXNzZWRNb3VzZShldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7ICBcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2RiY2xpY2snOiAgICBcclxuICAgICAgICAgICAgICAgIGNhc2UgJ21vdXNldXAnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kV2l0aFByZXNzZWRNb3VzZShldmVudC5jbGllbnRYKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gXHJcbiAgICAgICAgLy9pZihldmVudC50YXJnZXQuY2xvc2VzdCgnW2RhdGEtc2xpZGVyLWFycm93XScpKSB0aGlzLmFycm93cyhldmVudC50YXJnZXQpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIC8qIGFycm93cyhlbGVtKSB7XHJcbiAgICAgICAgbGV0IG9mZnNldFdpZHRoID0gdGhpcy5zbGlkZXJMaW5lLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIGxldCBsZWZ0ID0gcGFyc2VJbnQodGhpcy5zbGlkZXJMaW5lLnN0eWxlLmxlZnQpO1xyXG4gICAgICAgIGxldCBhbW91bnQgPSAoZWxlbS5kYXRhc2V0LnNsaWRlckFycm93ID09ICdsZWZ0JykgPyBsZWZ0ICsgb2Zmc2V0V2lkdGggOiBsZWZ0IC0gb2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgYW1vdW50ID0gKGFtb3VudCA+IDApID8gMCA6XHJcbiAgICAgICAgLy8gaWYgdGhlIHJlc3QgcGFydCBvZiBzbGlkZXIgbGluZSBzbWFsbGVyIHRoYW4gMTBweCB0aGVuIG5vIGNoYW5nZXNcclxuICAgICAgICAodGhpcy5zbGlkZXJMaW5lLnNjcm9sbFdpZHRoICsgYW1vdW50IDwgMTApID8gYW1vdW50ICsgb2Zmc2V0V2lkdGggOiBhbW91bnQ7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLmxlZnQgPSBhbW91bnQgKyBcInB4XCI7XHJcbiAgICB9ICovXHJcblxyXG4gICAgbW92ZVNsaWRlcihpbmRleCkgeyAvLyBjaGFuZ2VzIChtb3ZlcykgdGhlIHNsaWRlciB0YXBlIChzbGlkZXIgbGluZSkgcG9zaXRpb25cclxuICAgICAgICBsZXQgbGVmdCA9IHRoaXMuc2xpZGVyTGluZS5zY3JvbGxXaWR0aCAvIHRoaXMuc2xpZGVyTGluZS5jaGlsZHJlbi5sZW5ndGggKiBpbmRleDtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7bGVmdH1weClgO1xyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZVBvaW50cyhpbmRleCkgeyAvLyBjaGFuZ2VzIGEgY2xhc3Mgb2YgdGhlIHByZXNzZWQgYnV0dG9uIChzbGlkZXIgcG9pbnQpIGFuZCBtb3ZlcyB0aGUgc2xpZGVyIHRhcGUgKHNsaWRlciBsaW5lKSAgXHJcbiAgICAgICAgaW5kZXggPSAoaW5kZXggPCAwKSA/IHRoaXMuc2xpZGVyTGluZS5jaGlsZHJlbi5sZW5ndGggLSAxIDogXHJcbiAgICAgICAgICAgICAgICAoaW5kZXggPiB0aGlzLnNsaWRlckxpbmUuY2hpbGRyZW4ubGVuZ3RoIC0gMSkgPyAwIDogaW5kZXg7XHJcbiAgICAgICAgaWYodGhpcy5wb2ludHNFbGVtKSB7XHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRzRWxlbS5jaGlsZHJlblt0aGlzLnBvaW50TnVtYmVyXS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMucG9pbnRDbGFzc05hbWUpO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50c0VsZW0uY2hpbGRyZW5baW5kZXhdLmNsYXNzTGlzdC5hZGQodGhpcy5wb2ludENsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucG9pbnROdW1iZXIgPSBpbmRleDtcclxuICAgICAgICB0aGlzLm1vdmVTbGlkZXIoaW5kZXgpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0V2l0aFByZXNzZWRNb3VzZShldmVudCkge1xyXG4gICAgICAgIHRoaXMuaXNQcmVzc2VkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnN0YXJ0RGlzdGFuY2UgPSBldmVudC5jbGllbnRYO1xyXG4gICAgICAgIHRoaXMuc3RvcFRpbWVyKCk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdGlhbFNsaWRlID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLXNsaWRlci1pdGVtXScpOyAvL2RlY2lzaW9uIG9mIGN1cnJlbnRseSBmb3IgYSBzaW5nbGUgdmlzaWJsZSBzbGlkZSBvZiB0aGUgc2xpZGVyXHJcblxyXG4gICAgICAgIHRoaXMuaW5pdGlhbFRyYW5zZm9ybSA9ICtnZXRDb21wdXRlZFN0eWxlKHRoaXMuc2xpZGVyTGluZSkudHJhbnNmb3JtLnNwbGl0KCcsJylbNF07XHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zaXRpb24gPSAnaW5pdGlhbCc7XHJcblxyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm1vdmVXaXRoUHJlc3NlZE1vdXNlKTtcclxuICAgIH1cclxuICAgIGVuZFdpdGhQcmVzc2VkTW91c2UoY2xpZW50WCkge1xyXG4gICAgICAgIGlmKCF0aGlzLmlzUHJlc3NlZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLmlzUHJlc3NlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2l0aW9uID0gJyc7XHJcblxyXG4gICAgICAgIGxldCBkaWZmT2ZEaXN0YW5jZSA9IGNsaWVudFggLSB0aGlzLnN0YXJ0RGlzdGFuY2U7XHJcbiAgICAgICAgaWYoTWF0aC5hYnMoZGlmZk9mRGlzdGFuY2UpICA8IHRoaXMuc2xpZGVyTGluZS5vZmZzZXRXaWR0aCAqIC4yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgke3RoaXMuaW5pdGlhbFRyYW5zZm9ybX1weClgO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlUG9pbnRzKChkaWZmT2ZEaXN0YW5jZSA8IDApID8gdGhpcy5wb2ludE51bWJlciArIDEgOiB0aGlzLnBvaW50TnVtYmVyIC0gMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm1vdmVXaXRoUHJlc3NlZE1vdXNlKTtcclxuICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTtcclxuICAgIH1cclxuICAgIG1vdmVXaXRoUHJlc3NlZE1vdXNlKGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IGRpZmZPZkRpc3RhbmNlID0gIGV2ZW50LmNsaWVudFggLSB0aGlzLnN0YXJ0RGlzdGFuY2U7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHNoaWZ0ID0gdGhpcy5pbml0aWFsVHJhbnNmb3JtICsgZGlmZk9mRGlzdGFuY2U7XHJcbiAgICAgICAgbGV0IG1heFNoaWZ0ID0gLSh0aGlzLnNsaWRlckxpbmUuc2Nyb2xsV2lkdGggLSB0aGlzLnNsaWRlckxpbmUuY2xpZW50V2lkdGgpO1xyXG4gICAgICAgIHNoaWZ0ID0gKHNoaWZ0ID49IDApID8gMCA6XHJcbiAgICAgICAgICAgICAgICAoc2hpZnQgPD0gbWF4U2hpZnQpID8gbWF4U2hpZnQgOiBzaGlmdDsgICAgICAgXHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgke3NoaWZ0fXB4KWA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGN1cnJlbnRFbGVtID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZKTtcclxuICAgICAgICBpZighdGhpcy5zbGlkZXJMaW5lLmNvbnRhaW5zKGN1cnJlbnRFbGVtKSkgdGhpcy5lbmRXaXRoUHJlc3NlZE1vdXNlKHRoaXMucHJldkNsaWVudFgpO1xyXG5cclxuICAgICAgICB0aGlzLnByZXZDbGllbnRYID0gZXZlbnQuY2xpZW50WDsgXHJcblxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHN0YXJ0VGltZXIoKSB7XHJcbiAgICAgICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYHNldFRpbWVvdXQ6ICR7dGhpcy50aW1lb3V0fWApO1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLnBvaW50TnVtYmVyICsgMTtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VQb2ludHMoaW5kZXgpO1xyXG4gICAgICAgIH0sIHRoaXMudGltZSAqIDEwMDApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBzdG9wVGltZXIoKSB7XHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoMHB4KWA7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VQb2ludHMoMCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vLyBQYXR0ZXJuIG9mIHRoZSBIVE1MIHNsaWRlcjpcclxuLy8gYmxvY2sgc2xpZGVyICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkZWZpbmVzIHRoZSB0b3RhbCB3aWR0aCBvZiB0aGUgc2xpZGVyJ3MgcGFnZSAoY29udGFpbmVyKVxyXG4vLyAgICAgYmxvY2sgc2xpZGVyLWNvbnRhaW5lciAgICAgICAgICAgIC8vIGRlZmluZXMgYSB3aWR0aCBvZiB0aGUgc2xpZGVyIFxyXG4vLyAgICAgICAgIGJsb2NrIFtkYXRhLXNsaWRlci1saW5lXSAgICAgICAgICAgICAvLyBkZWZpbmVzIHRoZSB0YXBlIG9mIHRoZSBzbGlkZXIsIHRoYXQgbW92ZXMgdGhyb3VnaFxyXG4vLyAgICAgICAgICAgICBibG9ja3MgW2RhdGEtc2xpZGVyLWl0ZW09J251bWJlciddICogblxyXG4vLyAgICAgICAgIGJsb2NrIHNsaWRlci1hcnJvd3MgICBcclxuLy8gICAgICAgICBibG9jayBzbGlkZXItcG9pbnRzXHJcbi8vICAgICAgICAgICAgIGJsb2NrcyBbZGF0YS1zbGlkZXItcG9pbnQ9J251bWJlciddICogblxyXG5cclxuXHJcblxyXG5cclxuLy90aGlzLnRyYW5zaXRpb25TdGFydFRpbWVyKCk7IC8vIHVzZSB0cmFuc2l0aW9uU3RhcnRUaW1lciBpbnN0ZWFkIHVzdWFsbCBzdGFydFRpbWVyIHRvIGNvbnNpZGVyIHRyYW5zaXRpb24gdGltZVxyXG5cclxuLy90aGlzLnNsaWRlckxpbmUub250cmFuc2l0aW9uZW5kID0gZmFsc2U7XHJcblxyXG4vLyB0cmFuc2l0aW9uU3RhcnRUaW1lcigpIHsgLy8gc3RhcnRzIHRoZSBuZXh0IHRpbWUgaW50ZXJ2YWwgYWZ0ZXIgdGhlIGN1cnJlbnQgdHJhbnNpdGlvbiBvbmx5XHJcbi8vICAgICBpZihwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUodGhpcy5zbGlkZXJMaW5lKS50cmFuc2l0aW9uRHVyYXRpb24pKSB7IC8vIGlmIHRoZXJlJ3Mgc29tZSBhbmltYXRpb25cclxuLy8gICAgICAgICB0aGlzLnNsaWRlckxpbmUub250cmFuc2l0aW9uZW5kID0gKCkgPT4ge1xyXG4vLyAgICAgICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTtcclxuLy8gICAgICAgICAgICAgdGhpcy5zbGlkZXJMaW5lLm9udHJhbnNpdGlvbmVuZCA9IGZhbHNlO1xyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgdGhpcy5zdGFydFRpbWVyKCk7XHJcbi8vICAgICB9XHJcbi8vIH1cclxuXHJcbiIsImxldCBzdWJtZW51ID0ge1xyXG5cclxuICAgIGhhbmRsZUV2ZW50KGV2ZW50KSB7XHJcbiAgICAgICAgaWYoZXZlbnQudHlwZSA9ICdtb3VzZW92ZXInKSB0aGlzLnNldFN1Ym1lbnUoZXZlbnQudGFyZ2V0KTtcclxuICAgICAgICBpZihldmVudC50eXBlID0gJ21vdXNlb3V0JykgdGhpcy5yZW1vdmVTdWJtZW51KGV2ZW50LnRhcmdldCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldFN1Ym1lbnUoZWxlbSkge1xyXG4gICAgICAgIGlmKHRoaXMuaXNTdWJtZW51KSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMubWVudUl0ZW0gPSBlbGVtLmNsb3Nlc3QoJ1tkYXRhLXN1Ym1lbnVdJyk7XHJcbiAgICAgICAgaWYoIXRoaXMubWVudUl0ZW0pIHJldHVybjtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgc3VibWVudUl0ZW0gPSB0aGlzLm1lbnVJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5zdWJtZW51Jyk7XHJcbiAgICAgICAgaWYoIXN1Ym1lbnVJdGVtKSByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBjb29yZHMgPSBzdWJtZW51SXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBsZXQgb3ZlckVkZ2UgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggLSAoY29vcmRzLmxlZnQgKyBzdWJtZW51SXRlbS5vZmZzZXRXaWR0aCk7XHJcbiAgICAgICAgc3VibWVudUl0ZW0uc3R5bGUubGVmdCA9IChvdmVyRWRnZSA8IDApID8gb3ZlckVkZ2UgLSAxNSArICdweCcgOiAnJztcclxuXHJcbiAgICAgICAgdGhpcy5pc1N1Ym1lbnUgPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcbiAgICByZW1vdmVTdWJtZW51KGVsZW0pIHtcclxuICAgICAgICBpZighdGhpcy5pc1N1Ym1lbnUpIHJldHVybjtcclxuICAgICAgICBcclxuICAgICAgICBpZighdGhpcy5tZW51SXRlbS5jb250YWlucyhlbGVtKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLmlzU3VibWVudSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxufSJdfQ==
