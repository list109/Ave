let dropdown={handleEvent(t){let e=t.target.closest("[data-dropdown]");if(this.box&&!this.box.contains(e)&&this.isDropdown&&this.showDropdown(),!e)return;this.box=e,this.list=e.querySelector("[data-dropdown-list]");let s=e.querySelector("[data-dropdown-btn]");if(!this.list||!s)return;t.preventDefault(),t.target.closest("[data-dropdown-btn]")&&this.showDropdown();let i=t.target.closest("[data-dropdown-item]");i&&this.chooseDropdownItem(i,s)},chooseDropdownItem(t,e){let s=t.innerHTML,i=e.innerHTML;t.innerHTML=i,e.innerHTML=s,this.showDropdown()},showDropdown(){this.isDropdown=parseFloat(this.list.style.height)==this.list.scrollHeight,this.list.style.height=this.isDropdown?"":this.list.scrollHeight+"px",this.isDropdown=!this.isDropdown,this.list.dataset.dropdownList=this.isDropdown}},scrollLineWidth=window.innerWidth-document.documentElement.clientWidth;function menu(t,e){t.onclick=()=>{t.classList.toggle(e),document.body.classList.toggle(t.dataset.bodyClass),document.querySelector(".mobile__top").style.right=t.classList.contains(e)?scrollLineWidth+"px":""}}class Slider{constructor(t,{pointClassName:e,pointsElem:s,time:i,arrowLeft:n,arrowRight:r}){this.sliderLine=t.querySelector("[data-slider-line]"),this.sliderLine&&(this.sliderLine.style.cssText="transform: translateX(0px);",this.pointsElem=s,this.pointClassName=e||"pointClassName",this.pointNumber=0,this.interval,this.time=i,this.isPressed=!1,this.moveWithPressedMouse=this.moveWithPressedMouse.bind(this),parseInt(i)&&this.startTimer(),t.addEventListener("click",this.handleEvent.bind(this)),t.addEventListener("mousedown",this.handleEvent.bind(this)),t.addEventListener("mouseup",this.handleEvent.bind(this)),this.sliderLine.ontransitionend=()=>{this.completeTransition()},window.addEventListener("resize",this.reset.bind(this)))}handleEvent(t){let e=t.target.closest("[data-slider-point]");if(e&&"click"==t.type){if(e.classList.contains(this.pointClassName)||t.preventDefault(),e.dataset.sliderPoint-1==this.pointNumber)return;return this.time&&(this.stopTimer(),this.startTimer()),void this.changePoints(e.dataset.sliderPoint-1)}if(t.target.closest("[data-slider-line]")&&!this.isTransition)switch(t.type){case"mousedown":this.startWithPressedMouse(t);break;case"dbclick":case"mouseup":this.endWithPressedMouse(t.clientX)}t.target.closest("a")||t.preventDefault()}moveSlider(t){let e=this.sliderLine.scrollWidth/this.sliderLine.children.length*t;this.sliderLine.style.transform=`translateX(-${e}px)`}changePoints(t){t=t<0?this.sliderLine.children.length-1:t>this.sliderLine.children.length-1?0:t,this.pointsElem&&(this.pointsElem.children[this.pointNumber].classList.remove(this.pointClassName),this.pointsElem.children[t].classList.add(this.pointClassName)),this.pointNumber=t,this.moveSlider(t)}startWithPressedMouse(t){this.isPressed=!0,this.startDistance=t.clientX,this.stopTimer(),this.initialSlide=t.target.closest("[data-slider-item]"),this.initialTransform=+getComputedStyle(this.sliderLine).transform.split(",")[4],this.sliderLine.style.transition="initial",window.addEventListener("mousemove",this.moveWithPressedMouse)}endWithPressedMouse(t){if(!this.isPressed)return;this.isPressed=!1,this.sliderLine.style.transition="";let e=t-this.startDistance;Math.abs(e)<.2*this.sliderLine.offsetWidth?this.sliderLine.style.transform=`translateX(${this.initialTransform}px)`:this.changePoints(e<0?this.pointNumber+1:this.pointNumber-1),window.removeEventListener("mousemove",this.moveWithPressedMouse),this.startTimer()}moveWithPressedMouse(t){let e=t.clientX-this.startDistance,s=this.initialTransform+e,i=-(this.sliderLine.scrollWidth-this.sliderLine.clientWidth);s=s>=0?0:s<=i?i:s,this.sliderLine.style.transform=`translateX(${s}px)`;let n=document.elementFromPoint(t.clientX,t.clientY);this.sliderLine.contains(n)||this.endWithPressedMouse(this.prevClientX),this.prevClientX=t.clientX}completeTransition(){this.isTransition=!1}startTimer(){this.interval=setInterval(()=>{let t=this.pointNumber+1;this.changePoints(t),this.isTransition=!0},1e3*this.time)}stopTimer(){clearInterval(this.interval)}reset(){this.sliderLine.style.transform="translateX(0px)",this.changePoints(0)}}let submenu={handleEvent(t){(t.type="mouseover")&&this.setSubmenu(t.target),(t.type="mouseout")&&this.removeSubmenu(t.target)},setSubmenu(t){if(this.isSubmenu)return;if(this.menuItem=t.closest("[data-submenu]"),!this.menuItem)return;let e=this.menuItem.querySelector(".submenu");if(!e)return;let s=e.getBoundingClientRect(),i=document.documentElement.clientWidth-(s.left+e.offsetWidth);e.style.left=i<0?i-15+"px":"",this.isSubmenu=!0},removeSubmenu(t){this.isSubmenu&&this.menuItem.contains(t)&&(this.isSubmenu=!1)}};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLmpzIiwibWVudS5qcyIsInNsaWRlci5qcyIsInN1Ym1lbnUuanMiXSwibmFtZXMiOlsiZHJvcGRvd24iLCJbb2JqZWN0IE9iamVjdF0iLCJldmVudCIsImJveCIsInRhcmdldCIsImNsb3Nlc3QiLCJ0aGlzIiwiY29udGFpbnMiLCJpc0Ryb3Bkb3duIiwic2hvd0Ryb3Bkb3duIiwibGlzdCIsInF1ZXJ5U2VsZWN0b3IiLCJidG4iLCJwcmV2ZW50RGVmYXVsdCIsImVsZW0iLCJjaG9vc2VEcm9wZG93bkl0ZW0iLCJlbGVtQ2hpbGQiLCJpbm5lckhUTUwiLCJidG5DaGlsZCIsInBhcnNlRmxvYXQiLCJzdHlsZSIsImhlaWdodCIsInNjcm9sbEhlaWdodCIsImRhdGFzZXQiLCJkcm9wZG93bkxpc3QiLCJzY3JvbGxMaW5lV2lkdGgiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiZG9jdW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsIm1lbnUiLCJidG5DbGFzcyIsIm9uY2xpY2siLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJib2R5IiwiYm9keUNsYXNzIiwicmlnaHQiLCJTbGlkZXIiLCJzbGlkZXIiLCJwb2ludENsYXNzTmFtZSIsInBvaW50c0VsZW0iLCJ0aW1lIiwiYXJyb3dMZWZ0IiwiYXJyb3dSaWdodCIsInNsaWRlckxpbmUiLCJjc3NUZXh0IiwicG9pbnROdW1iZXIiLCJpbnRlcnZhbCIsImlzUHJlc3NlZCIsIm1vdmVXaXRoUHJlc3NlZE1vdXNlIiwiYmluZCIsInBhcnNlSW50Iiwic3RhcnRUaW1lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVFdmVudCIsIm9udHJhbnNpdGlvbmVuZCIsImNvbXBsZXRlVHJhbnNpdGlvbiIsInJlc2V0IiwicG9pbnQiLCJ0eXBlIiwic2xpZGVyUG9pbnQiLCJzdG9wVGltZXIiLCJjaGFuZ2VQb2ludHMiLCJpc1RyYW5zaXRpb24iLCJzdGFydFdpdGhQcmVzc2VkTW91c2UiLCJlbmRXaXRoUHJlc3NlZE1vdXNlIiwiY2xpZW50WCIsImluZGV4IiwibGVmdCIsInNjcm9sbFdpZHRoIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJ0cmFuc2Zvcm0iLCJyZW1vdmUiLCJhZGQiLCJtb3ZlU2xpZGVyIiwic3RhcnREaXN0YW5jZSIsImluaXRpYWxTbGlkZSIsImluaXRpYWxUcmFuc2Zvcm0iLCJnZXRDb21wdXRlZFN0eWxlIiwic3BsaXQiLCJ0cmFuc2l0aW9uIiwiZGlmZk9mRGlzdGFuY2UiLCJNYXRoIiwiYWJzIiwib2Zmc2V0V2lkdGgiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2hpZnQiLCJtYXhTaGlmdCIsImN1cnJlbnRFbGVtIiwiZWxlbWVudEZyb21Qb2ludCIsImNsaWVudFkiLCJwcmV2Q2xpZW50WCIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInN1Ym1lbnUiLCJzZXRTdWJtZW51IiwicmVtb3ZlU3VibWVudSIsImlzU3VibWVudSIsIm1lbnVJdGVtIiwic3VibWVudUl0ZW0iLCJjb29yZHMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvdmVyRWRnZSJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBQUEsU0FBQSxDQUNBQyxZQUFBQyxHQUNBLElBQUFDLEVBQUFELEVBQUFFLE9BQUFDLFFBQUEsbUJBRUEsR0FEQUMsS0FBQUgsTUFBQUcsS0FBQUgsSUFBQUksU0FBQUosSUFBQUcsS0FBQUUsWUFBQUYsS0FBQUcsZ0JBQ0FOLEVBQUEsT0FDQUcsS0FBQUgsSUFBQUEsRUFFQUcsS0FBQUksS0FBQVAsRUFBQVEsY0FBQSx3QkFDQSxJQUFBQyxFQUFBVCxFQUFBUSxjQUFBLHVCQUNBLElBQUFMLEtBQUFJLE9BQUFFLEVBQUEsT0FFQVYsRUFBQVcsaUJBRUFYLEVBQUFFLE9BQUFDLFFBQUEsd0JBQ0FDLEtBQUFHLGVBR0EsSUFBQUssRUFBQVosRUFBQUUsT0FBQUMsUUFBQSx3QkFDQVMsR0FBQVIsS0FBQVMsbUJBQUFELEVBQUFGLElBRUFYLG1CQUFBYSxFQUFBRixHQUNBLElB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Iiwic291cmNlc0NvbnRlbnQiOlsibGV0IGRyb3Bkb3duID0ge1xyXG4gICAgaGFuZGxlRXZlbnQoZXZlbnQpIHtcclxuICAgICAgICBsZXQgYm94ID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLWRyb3Bkb3duXScpO1xyXG4gICAgICAgIGlmKHRoaXMuYm94ICYmICF0aGlzLmJveC5jb250YWlucyhib3gpICYmIHRoaXMuaXNEcm9wZG93bikgdGhpcy5zaG93RHJvcGRvd24oKTtcclxuICAgICAgICBpZighYm94KSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5ib3ggPSBib3g7XHJcblxyXG4gICAgICAgIHRoaXMubGlzdCA9IGJveC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1kcm9wZG93bi1saXN0XScpO1xyXG4gICAgICAgIGxldCBidG4gPSBib3gucXVlcnlTZWxlY3RvcignW2RhdGEtZHJvcGRvd24tYnRuXScpO1xyXG4gICAgICAgIGlmKCF0aGlzLmxpc3QgfHwgIWJ0bikgcmV0dXJuO1xyXG5cclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICBpZihldmVudC50YXJnZXQuY2xvc2VzdCgnW2RhdGEtZHJvcGRvd24tYnRuXScpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0Ryb3Bkb3duKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgZWxlbSA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1kcm9wZG93bi1pdGVtXScpO1xyXG4gICAgICAgIGlmKGVsZW0pIHRoaXMuY2hvb3NlRHJvcGRvd25JdGVtKGVsZW0sIGJ0bik7XHJcbiAgICB9LFxyXG4gICAgY2hvb3NlRHJvcGRvd25JdGVtKGVsZW0sIGJ0bikge1xyXG4gICAgICAgIGxldCBlbGVtQ2hpbGQgPSBlbGVtLmlubmVySFRNTDtcclxuICAgICAgICBsZXQgYnRuQ2hpbGQgPSBidG4uaW5uZXJIVE1MO1xyXG5cclxuICAgICAgICBlbGVtLmlubmVySFRNTCA9IGJ0bkNoaWxkO1xyXG4gICAgICAgIGJ0bi5pbm5lckhUTUwgPSBlbGVtQ2hpbGQ7XHJcbiAgICAgICAgdGhpcy5zaG93RHJvcGRvd24oKTtcclxuICAgIH0sXHJcbiAgICBzaG93RHJvcGRvd24oKSB7XHJcbiAgICAgICAgdGhpcy5pc0Ryb3Bkb3duID0gKHBhcnNlRmxvYXQodGhpcy5saXN0LnN0eWxlLmhlaWdodCkgPT0gdGhpcy5saXN0LnNjcm9sbEhlaWdodCk7XHJcbiAgICAgICAgdGhpcy5saXN0LnN0eWxlLmhlaWdodCA9ICh0aGlzLmlzRHJvcGRvd24pID8gJycgOiB0aGlzLmxpc3Quc2Nyb2xsSGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICB0aGlzLmlzRHJvcGRvd24gPSAhdGhpcy5pc0Ryb3Bkb3duO1xyXG4gICAgICAgIHRoaXMubGlzdC5kYXRhc2V0LmRyb3Bkb3duTGlzdCA9IHRoaXMuaXNEcm9wZG93bjtcclxuICAgIH1cclxufSIsImxldCBzY3JvbGxMaW5lV2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCAtIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcclxuXHJcbmZ1bmN0aW9uIG1lbnUoYnRuLCBidG5DbGFzcykge1xyXG4gICAgYnRuLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QudG9nZ2xlKGJ0bkNsYXNzKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKGJ0bi5kYXRhc2V0LmJvZHlDbGFzcyk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2JpbGVfX3RvcCcpLnN0eWxlLnJpZ2h0ID0gKGJ0bi5jbGFzc0xpc3QuY29udGFpbnMoYnRuQ2xhc3MpKSA/IFxyXG4gICAgICAgICAgICBzY3JvbGxMaW5lV2lkdGggKyAncHgnXHJcbiAgICAgICAgICAgIDogJyc7IFxyXG4gICAgfVxyXG59OyIsIlxyXG5jbGFzcyBTbGlkZXIge1xyXG4gICAgY29uc3RydWN0b3Ioc2xpZGVyLCB7IHBvaW50Q2xhc3NOYW1lLCBwb2ludHNFbGVtLCB0aW1lLCBhcnJvd0xlZnQsIGFycm93UmlnaHQgfSkgeyAvL3RoZSB0aW1lIGFyZ3VtZW50IHRha2VzIGEgbnVtYmVyIHZhbHVlIGFzIHNlY29uZHNcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUgPSBzbGlkZXIucXVlcnlTZWxlY3RvcignW2RhdGEtc2xpZGVyLWxpbmVdJyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNsaWRlckxpbmUpIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLmNzc1RleHQgPSBcInRyYW5zZm9ybTogdHJhbnNsYXRlWCgwcHgpO1wiXHJcblxyXG4gICAgICAgIHRoaXMucG9pbnRzRWxlbSA9IHBvaW50c0VsZW07XHJcbiAgICAgICAgdGhpcy5wb2ludENsYXNzTmFtZSA9IHBvaW50Q2xhc3NOYW1lIHx8ICdwb2ludENsYXNzTmFtZSc7XHJcbiAgICAgICAgdGhpcy5wb2ludE51bWJlciA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWw7XHJcbiAgICAgICAgdGhpcy50aW1lID0gdGltZTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1ByZXNzZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm1vdmVXaXRoUHJlc3NlZE1vdXNlID0gdGhpcy5tb3ZlV2l0aFByZXNzZWRNb3VzZS5iaW5kKHRoaXMpO1xyXG5cclxuICAgICAgICBpZiAocGFyc2VJbnQodGltZSkpIHRoaXMuc3RhcnRUaW1lcigpO1xyXG5cclxuICAgICAgICBzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUV2ZW50LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZUV2ZW50LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUub250cmFuc2l0aW9uZW5kID0gKCkgPT4geyB0aGlzLmNvbXBsZXRlVHJhbnNpdGlvbigpIH07XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVzZXQuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlRXZlbnQoZXZlbnQpIHtcclxuXHJcbiAgICAgICAgbGV0IHBvaW50ID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLXNsaWRlci1wb2ludF0nKTtcclxuICAgICAgICBpZiAocG9pbnQgJiYgZXZlbnQudHlwZSA9PSBcImNsaWNrXCIpIHtcclxuICAgICAgICAgICAgaWYgKCFwb2ludC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5wb2ludENsYXNzTmFtZSkpIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vcHJldmVudCB0aGUgcHJlc3NlZCBsaW5rIGdvaW5nIGlmIGl0IGlzIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgICAgIGlmIChwb2ludC5kYXRhc2V0LnNsaWRlclBvaW50IC0gMSA9PSB0aGlzLnBvaW50TnVtYmVyKSByZXR1cm47IC8vaWYgdGhlIHByZXNzZWQgYnV0dG9uIGlzIHRoZSBzYW1lIG9uZSBsaWtlIGluIHRoZSBwcmV2aW91cyB0aW1lIHRoZW4gdG8gcmV0dXJuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRpbWUpIHsgLy8gaWYgdGhlIHBvaW50IGhhdmUgcHJlc3NlZCB0aGVuIHRvIGNhbmNlbCB0aGUgY3VycmVudCB0aW1lciBhbmQgc3RhcnQgaXQgdW50aWxsIHRoZSB0cmFuc2l0aW9uIGVuZCBcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcFRpbWVyKCk7IC8vIHN0b3AgdGhlIHRpbWVyIGFueXdheVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydFRpbWVyKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VQb2ludHMocG9pbnQuZGF0YXNldC5zbGlkZXJQb2ludCAtIDEpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLXNsaWRlci1saW5lXScpICYmICF0aGlzLmlzVHJhbnNpdGlvbikge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ21vdXNlZG93bic6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydFdpdGhQcmVzc2VkTW91c2UoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGJjbGljayc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtb3VzZXVwJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZFdpdGhQcmVzc2VkTW91c2UoZXZlbnQuY2xpZW50WCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCFldmVudC50YXJnZXQuY2xvc2VzdCgnYScpKSBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIC8vaWYoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLXNsaWRlci1hcnJvd10nKSkgdGhpcy5hcnJvd3MoZXZlbnQudGFyZ2V0KTsgIFxyXG4gICAgfVxyXG4gICAgLyogYXJyb3dzKGVsZW0pIHtcclxuICAgICAgICBsZXQgb2Zmc2V0V2lkdGggPSB0aGlzLnNsaWRlckxpbmUub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgbGV0IGxlZnQgPSBwYXJzZUludCh0aGlzLnNsaWRlckxpbmUuc3R5bGUubGVmdCk7XHJcbiAgICAgICAgbGV0IGFtb3VudCA9IChlbGVtLmRhdGFzZXQuc2xpZGVyQXJyb3cgPT0gJ2xlZnQnKSA/IGxlZnQgKyBvZmZzZXRXaWR0aCA6IGxlZnQgLSBvZmZzZXRXaWR0aDtcclxuICAgICAgICBhbW91bnQgPSAoYW1vdW50ID4gMCkgPyAwIDpcclxuICAgICAgICAvLyBpZiB0aGUgcmVzdCBwYXJ0IG9mIHNsaWRlciBsaW5lIHNtYWxsZXIgdGhhbiAxMHB4IHRoZW4gbm8gY2hhbmdlc1xyXG4gICAgICAgICh0aGlzLnNsaWRlckxpbmUuc2Nyb2xsV2lkdGggKyBhbW91bnQgPCAxMCkgPyBhbW91bnQgKyBvZmZzZXRXaWR0aCA6IGFtb3VudDtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUubGVmdCA9IGFtb3VudCArIFwicHhcIjtcclxuICAgIH0gKi9cclxuXHJcbiAgICBtb3ZlU2xpZGVyKGluZGV4KSB7IC8vIGNoYW5nZXMgKG1vdmVzKSB0aGUgc2xpZGVyIHRhcGUgKHNsaWRlciBsaW5lKSBwb3NpdGlvblxyXG4gICAgICAgIGxldCBsZWZ0ID0gdGhpcy5zbGlkZXJMaW5lLnNjcm9sbFdpZHRoIC8gdGhpcy5zbGlkZXJMaW5lLmNoaWxkcmVuLmxlbmd0aCAqIGluZGV4O1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHtsZWZ0fXB4KWA7XHJcbiAgICB9XHJcblxyXG4gICAgY2hhbmdlUG9pbnRzKGluZGV4KSB7IC8vIGNoYW5nZXMgYSBjbGFzcyBvZiB0aGUgcHJlc3NlZCBidXR0b24gKHNsaWRlciBwb2ludCkgYW5kIG1vdmVzIHRoZSBzbGlkZXIgdGFwZSAoc2xpZGVyIGxpbmUpICBcclxuICAgICAgICBpbmRleCA9IChpbmRleCA8IDApID8gdGhpcy5zbGlkZXJMaW5lLmNoaWxkcmVuLmxlbmd0aCAtIDEgOlxyXG4gICAgICAgICAgICAoaW5kZXggPiB0aGlzLnNsaWRlckxpbmUuY2hpbGRyZW4ubGVuZ3RoIC0gMSkgPyAwIDogaW5kZXg7XHJcbiAgICAgICAgaWYgKHRoaXMucG9pbnRzRWxlbSkge1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50c0VsZW0uY2hpbGRyZW5bdGhpcy5wb2ludE51bWJlcl0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLnBvaW50Q2xhc3NOYW1lKTtcclxuICAgICAgICAgICAgdGhpcy5wb2ludHNFbGVtLmNoaWxkcmVuW2luZGV4XS5jbGFzc0xpc3QuYWRkKHRoaXMucG9pbnRDbGFzc05hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBvaW50TnVtYmVyID0gaW5kZXg7XHJcbiAgICAgICAgdGhpcy5tb3ZlU2xpZGVyKGluZGV4KTtcclxuICAgIH1cclxuXHJcbiAgICBzdGFydFdpdGhQcmVzc2VkTW91c2UoZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmlzUHJlc3NlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zdGFydERpc3RhbmNlID0gZXZlbnQuY2xpZW50WDtcclxuICAgICAgICB0aGlzLnN0b3BUaW1lcigpO1xyXG5cclxuICAgICAgICB0aGlzLmluaXRpYWxTbGlkZSA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1zbGlkZXItaXRlbV0nKTsgLy9kZWNpc2lvbiBvZiBjdXJyZW50bHkgZm9yIGEgc2luZ2xlIHZpc2libGUgc2xpZGUgb2YgdGhlIHNsaWRlclxyXG5cclxuICAgICAgICB0aGlzLmluaXRpYWxUcmFuc2Zvcm0gPSArZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLnNsaWRlckxpbmUpLnRyYW5zZm9ybS5zcGxpdCgnLCcpWzRdO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2l0aW9uID0gJ2luaXRpYWwnO1xyXG5cclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5tb3ZlV2l0aFByZXNzZWRNb3VzZSk7XHJcbiAgICB9XHJcbiAgICBlbmRXaXRoUHJlc3NlZE1vdXNlKGNsaWVudFgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNQcmVzc2VkKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuaXNQcmVzc2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zaXRpb24gPSAnJztcclxuXHJcbiAgICAgICAgbGV0IGRpZmZPZkRpc3RhbmNlID0gY2xpZW50WCAtIHRoaXMuc3RhcnREaXN0YW5jZTtcclxuICAgICAgICBpZiAoTWF0aC5hYnMoZGlmZk9mRGlzdGFuY2UpIDwgdGhpcy5zbGlkZXJMaW5lLm9mZnNldFdpZHRoICogLjIpIHtcclxuICAgICAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7dGhpcy5pbml0aWFsVHJhbnNmb3JtfXB4KWA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VQb2ludHMoKGRpZmZPZkRpc3RhbmNlIDwgMCkgPyB0aGlzLnBvaW50TnVtYmVyICsgMSA6IHRoaXMucG9pbnROdW1iZXIgLSAxKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm1vdmVXaXRoUHJlc3NlZE1vdXNlKTtcclxuICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTtcclxuICAgIH1cclxuICAgIG1vdmVXaXRoUHJlc3NlZE1vdXNlKGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IGRpZmZPZkRpc3RhbmNlID0gZXZlbnQuY2xpZW50WCAtIHRoaXMuc3RhcnREaXN0YW5jZTtcclxuXHJcbiAgICAgICAgbGV0IHNoaWZ0ID0gdGhpcy5pbml0aWFsVHJhbnNmb3JtICsgZGlmZk9mRGlzdGFuY2U7XHJcbiAgICAgICAgbGV0IG1heFNoaWZ0ID0gLSh0aGlzLnNsaWRlckxpbmUuc2Nyb2xsV2lkdGggLSB0aGlzLnNsaWRlckxpbmUuY2xpZW50V2lkdGgpO1xyXG4gICAgICAgIHNoaWZ0ID0gKHNoaWZ0ID49IDApID8gMCA6XHJcbiAgICAgICAgICAgIChzaGlmdCA8PSBtYXhTaGlmdCkgPyBtYXhTaGlmdCA6IHNoaWZ0O1xyXG5cclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHtzaGlmdH1weClgO1xyXG5cclxuICAgICAgICBsZXQgY3VycmVudEVsZW0gPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkpO1xyXG4gICAgICAgIGlmICghdGhpcy5zbGlkZXJMaW5lLmNvbnRhaW5zKGN1cnJlbnRFbGVtKSkgdGhpcy5lbmRXaXRoUHJlc3NlZE1vdXNlKHRoaXMucHJldkNsaWVudFgpO1xyXG5cclxuICAgICAgICB0aGlzLnByZXZDbGllbnRYID0gZXZlbnQuY2xpZW50WDtcclxuICAgIH1cclxuXHJcbiAgICBjb21wbGV0ZVRyYW5zaXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5pc1RyYW5zaXRpb24gPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBzdGFydFRpbWVyKCkge1xyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBpbmRleCA9IHRoaXMucG9pbnROdW1iZXIgKyAxO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZVBvaW50cyhpbmRleCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmlzVHJhbnNpdGlvbiA9IHRydWU7XHJcbiAgICAgICAgfSwgdGhpcy50aW1lICogMTAwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RvcFRpbWVyKCkge1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXQoKSB7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKDBweClgO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlUG9pbnRzKDApO1xyXG4gICAgfVxyXG59O1xyXG5cclxuLy8gUGF0dGVybiBvZiB0aGUgSFRNTCBzbGlkZXI6XHJcbi8vIGJsb2NrIHNsaWRlciAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGVmaW5lcyB0aGUgdG90YWwgd2lkdGggb2YgdGhlIHNsaWRlcidzIHBhZ2UgKGNvbnRhaW5lcilcclxuLy8gICAgIGJsb2NrIHNsaWRlci1jb250YWluZXIgICAgICAgICAgICAvLyBkZWZpbmVzIGEgd2lkdGggb2YgdGhlIHNsaWRlciBcclxuLy8gICAgICAgICBibG9jayBbZGF0YS1zbGlkZXItbGluZV0gICAgICAgICAgICAgLy8gZGVmaW5lcyB0aGUgdGFwZSBvZiB0aGUgc2xpZGVyLCB0aGF0IG1vdmVzIHRocm91Z2hcclxuLy8gICAgICAgICAgICAgYmxvY2tzIFtkYXRhLXNsaWRlci1pdGVtPSdudW1iZXInXSAqIG5cclxuLy8gICAgICAgICBibG9jayBzbGlkZXItYXJyb3dzICAgXHJcbi8vICAgICAgICAgYmxvY2sgc2xpZGVyLXBvaW50c1xyXG4vLyAgICAgICAgICAgICBibG9ja3MgW2RhdGEtc2xpZGVyLXBvaW50PSdudW1iZXInXSAqIG5cclxuXHJcblxyXG5cclxuXHJcbi8vdGhpcy50cmFuc2l0aW9uU3RhcnRUaW1lcigpOyAvLyB1c2UgdHJhbnNpdGlvblN0YXJ0VGltZXIgaW5zdGVhZCB1c3VhbGwgc3RhcnRUaW1lciB0byBjb25zaWRlciB0cmFuc2l0aW9uIHRpbWVcclxuXHJcbi8vdGhpcy5zbGlkZXJMaW5lLm9udHJhbnNpdGlvbmVuZCA9IGZhbHNlO1xyXG5cclxuLy8gdHJhbnNpdGlvblN0YXJ0VGltZXIoKSB7IC8vIHN0YXJ0cyB0aGUgbmV4dCB0aW1lIGludGVydmFsIGFmdGVyIHRoZSBjdXJyZW50IHRyYW5zaXRpb24gb25seVxyXG4vLyAgICAgaWYocGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKHRoaXMuc2xpZGVyTGluZSkudHJhbnNpdGlvbkR1cmF0aW9uKSkgeyAvLyBpZiB0aGVyZSdzIHNvbWUgYW5pbWF0aW9uXHJcbi8vICAgICAgICAgdGhpcy5zbGlkZXJMaW5lLm9udHJhbnNpdGlvbmVuZCA9ICgpID0+IHtcclxuLy8gICAgICAgICAgICAgdGhpcy5zdGFydFRpbWVyKCk7XHJcbi8vICAgICAgICAgICAgIHRoaXMuc2xpZGVyTGluZS5vbnRyYW5zaXRpb25lbmQgPSBmYWxzZTtcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9IGVsc2Uge1xyXG4vLyAgICAgICAgIHRoaXMuc3RhcnRUaW1lcigpO1xyXG4vLyAgICAgfVxyXG4vLyB9XHJcblxyXG4iLCJsZXQgc3VibWVudSA9IHtcclxuXHJcbiAgICBoYW5kbGVFdmVudChldmVudCkge1xyXG4gICAgICAgIGlmKGV2ZW50LnR5cGUgPSAnbW91c2VvdmVyJykgdGhpcy5zZXRTdWJtZW51KGV2ZW50LnRhcmdldCk7XHJcbiAgICAgICAgaWYoZXZlbnQudHlwZSA9ICdtb3VzZW91dCcpIHRoaXMucmVtb3ZlU3VibWVudShldmVudC50YXJnZXQpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRTdWJtZW51KGVsZW0pIHtcclxuICAgICAgICBpZih0aGlzLmlzU3VibWVudSkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLm1lbnVJdGVtID0gZWxlbS5jbG9zZXN0KCdbZGF0YS1zdWJtZW51XScpO1xyXG4gICAgICAgIGlmKCF0aGlzLm1lbnVJdGVtKSByZXR1cm47XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHN1Ym1lbnVJdGVtID0gdGhpcy5tZW51SXRlbS5xdWVyeVNlbGVjdG9yKCcuc3VibWVudScpO1xyXG4gICAgICAgIGlmKCFzdWJtZW51SXRlbSkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgY29vcmRzID0gc3VibWVudUl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgbGV0IG92ZXJFZGdlID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIC0gKGNvb3Jkcy5sZWZ0ICsgc3VibWVudUl0ZW0ub2Zmc2V0V2lkdGgpO1xyXG4gICAgICAgIHN1Ym1lbnVJdGVtLnN0eWxlLmxlZnQgPSAob3ZlckVkZ2UgPCAwKSA/IG92ZXJFZGdlIC0gMTUgKyAncHgnIDogJyc7XHJcblxyXG4gICAgICAgIHRoaXMuaXNTdWJtZW51ID0gdHJ1ZTtcclxuICAgIH0sXHJcblxyXG4gICAgcmVtb3ZlU3VibWVudShlbGVtKSB7XHJcbiAgICAgICAgaWYoIXRoaXMuaXNTdWJtZW51KSByZXR1cm47XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYoIXRoaXMubWVudUl0ZW0uY29udGFpbnMoZWxlbSkpIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy5pc1N1Ym1lbnUgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbn0iXX0=
