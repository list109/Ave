let dropdown={handleEvent(t){let e=t.target.closest("[data-dropdown]");if(this.box&&!this.box.contains(e)&&this.isDropdown&&this.showDropdown(),!e)return;this.box=e,this.list=e.querySelector("[data-dropdown-list]");let s=e.querySelector("[data-dropdown-btn]");if(!this.list||!s)return;t.preventDefault(),t.target.closest("[data-dropdown-btn]")&&this.showDropdown();let i=t.target.closest("[data-dropdown-item]");i&&this.chooseDropdownItem(i,s)},chooseDropdownItem(t,e){let s=t.innerHTML,i=e.innerHTML;t.innerHTML=i,e.innerHTML=s,this.showDropdown()},showDropdown(){this.isDropdown=parseFloat(this.list.style.height)==this.list.scrollHeight,this.list.style.height=this.isDropdown?"":this.list.scrollHeight+"px",this.isDropdown=!this.isDropdown,this.list.dataset.dropdownList=this.isDropdown}},scrollLineWidth=window.innerWidth-document.documentElement.clientWidth;function menu(t,e){t.onclick=()=>{t.classList.toggle(e),document.body.classList.toggle(t.dataset.bodyClass)}}class Slider{constructor(t,{pointClassName:e,pointsElem:s,time:i,arrowLeft:n,arrowRight:r}){this.sliderLine=t.querySelector("[data-slider-line]"),this.sliderLine&&(this.sliderLine.style.cssText="transform: translateX(0px);",this.pointsElem=s,this.pointClassName=e||"pointClassName",this.pointNumber=0,this.interval,this.time=i,this.isPressed=!1,this.moveWithPressedMouse=this.moveWithPressedMouse.bind(this),parseInt(i)&&this.startTimer(),t.addEventListener("click",this.handleEvent.bind(this)),t.addEventListener("mousedown",this.handleEvent.bind(this)),t.addEventListener("mouseup",this.handleEvent.bind(this)),this.sliderLine.ontransitionend=()=>{this.completeTransition()},window.addEventListener("resize",this.reset.bind(this)))}handleEvent(t){let e=t.target.closest("[data-slider-point]");if(e&&"click"==t.type){if(e.classList.contains(this.pointClassName)||t.preventDefault(),e.dataset.sliderPoint-1==this.pointNumber)return;return this.time&&(this.stopTimer(),this.startTimer()),void this.changePoints(e.dataset.sliderPoint-1)}if(t.target.closest("[data-slider-line]")&&!this.isTransition)switch(t.type){case"mousedown":this.startWithPressedMouse(t);break;case"dbclick":case"mouseup":this.endWithPressedMouse(t.clientX)}t.target.closest("a")||t.preventDefault()}moveSlider(t){let e=this.sliderLine.scrollWidth/this.sliderLine.children.length*t;this.sliderLine.style.transform=`translateX(-${e}px)`}changePoints(t){t=t<0?this.sliderLine.children.length-1:t>this.sliderLine.children.length-1?0:t,this.pointsElem&&(this.pointsElem.children[this.pointNumber].classList.remove(this.pointClassName),this.pointsElem.children[t].classList.add(this.pointClassName)),this.pointNumber=t,this.moveSlider(t)}startWithPressedMouse(t){this.isPressed=!0,this.startDistance=t.clientX,this.stopTimer(),this.initialSlide=t.target.closest("[data-slider-item]"),this.initialTransform=+getComputedStyle(this.sliderLine).transform.split(",")[4],this.sliderLine.style.transition="initial",window.addEventListener("mousemove",this.moveWithPressedMouse)}endWithPressedMouse(t){if(!this.isPressed)return;this.isPressed=!1,this.sliderLine.style.transition="";let e=t-this.startDistance;Math.abs(e)<.2*this.sliderLine.offsetWidth?this.sliderLine.style.transform=`translateX(${this.initialTransform}px)`:this.changePoints(e<0?this.pointNumber+1:this.pointNumber-1),window.removeEventListener("mousemove",this.moveWithPressedMouse),this.isTransition=!0,this.startTimer()}moveWithPressedMouse(t){let e=t.clientX-this.startDistance,s=this.initialTransform+e,i=-(this.sliderLine.scrollWidth-this.sliderLine.clientWidth);s=s>=0?0:s<=i?i:s,this.sliderLine.style.transform=`translateX(${s}px)`;let n=document.elementFromPoint(t.clientX,t.clientY);this.sliderLine.contains(n)||this.endWithPressedMouse(this.prevClientX),this.prevClientX=t.clientX}completeTransition(){this.isTransition=!1}startTimer(){this.interval=setInterval(()=>{let t=this.pointNumber+1;this.changePoints(t),this.isTransition=!0},1e3*this.time)}stopTimer(){clearInterval(this.interval)}reset(){this.sliderLine.style.transform="translateX(0px)",this.changePoints(0)}}let submenu={handleEvent(t){(t.type="mouseover")&&this.setSubmenu(t.target),(t.type="mouseout")&&this.removeSubmenu(t.target)},setSubmenu(t){if(this.isSubmenu)return;if(this.menuItem=t.closest("[data-submenu]"),!this.menuItem)return;let e=this.menuItem.querySelector(".submenu");if(!e)return;let s=e.getBoundingClientRect(),i=document.documentElement.clientWidth-(s.left+e.offsetWidth);e.style.left=i<0?i-15+"px":"",this.isSubmenu=!0},removeSubmenu(t){this.isSubmenu&&this.menuItem.contains(t)&&(this.isSubmenu=!1)}};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLmpzIiwibWVudS5qcyIsInNsaWRlci5qcyIsInN1Ym1lbnUuanMiXSwibmFtZXMiOlsiZHJvcGRvd24iLCJbb2JqZWN0IE9iamVjdF0iLCJldmVudCIsImJveCIsInRhcmdldCIsImNsb3Nlc3QiLCJ0aGlzIiwiY29udGFpbnMiLCJpc0Ryb3Bkb3duIiwic2hvd0Ryb3Bkb3duIiwibGlzdCIsInF1ZXJ5U2VsZWN0b3IiLCJidG4iLCJwcmV2ZW50RGVmYXVsdCIsImVsZW0iLCJjaG9vc2VEcm9wZG93bkl0ZW0iLCJlbGVtQ2hpbGQiLCJpbm5lckhUTUwiLCJidG5DaGlsZCIsInBhcnNlRmxvYXQiLCJzdHlsZSIsImhlaWdodCIsInNjcm9sbEhlaWdodCIsImRhdGFzZXQiLCJkcm9wZG93bkxpc3QiLCJzY3JvbGxMaW5lV2lkdGgiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiZG9jdW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsIm1lbnUiLCJidG5DbGFzcyIsIm9uY2xpY2siLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJib2R5IiwiYm9keUNsYXNzIiwiU2xpZGVyIiwic2xpZGVyIiwicG9pbnRDbGFzc05hbWUiLCJwb2ludHNFbGVtIiwidGltZSIsImFycm93TGVmdCIsImFycm93UmlnaHQiLCJzbGlkZXJMaW5lIiwiY3NzVGV4dCIsInBvaW50TnVtYmVyIiwiaW50ZXJ2YWwiLCJpc1ByZXNzZWQiLCJtb3ZlV2l0aFByZXNzZWRNb3VzZSIsImJpbmQiLCJwYXJzZUludCIsInN0YXJ0VGltZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlRXZlbnQiLCJvbnRyYW5zaXRpb25lbmQiLCJjb21wbGV0ZVRyYW5zaXRpb24iLCJyZXNldCIsInBvaW50IiwidHlwZSIsInNsaWRlclBvaW50Iiwic3RvcFRpbWVyIiwiY2hhbmdlUG9pbnRzIiwiaXNUcmFuc2l0aW9uIiwic3RhcnRXaXRoUHJlc3NlZE1vdXNlIiwiZW5kV2l0aFByZXNzZWRNb3VzZSIsImNsaWVudFgiLCJpbmRleCIsImxlZnQiLCJzY3JvbGxXaWR0aCIsImNoaWxkcmVuIiwibGVuZ3RoIiwidHJhbnNmb3JtIiwicmVtb3ZlIiwiYWRkIiwibW92ZVNsaWRlciIsInN0YXJ0RGlzdGFuY2UiLCJpbml0aWFsU2xpZGUiLCJpbml0aWFsVHJhbnNmb3JtIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInNwbGl0IiwidHJhbnNpdGlvbiIsImRpZmZPZkRpc3RhbmNlIiwiTWF0aCIsImFicyIsIm9mZnNldFdpZHRoIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNoaWZ0IiwibWF4U2hpZnQiLCJjdXJyZW50RWxlbSIsImVsZW1lbnRGcm9tUG9pbnQiLCJjbGllbnRZIiwicHJldkNsaWVudFgiLCJzZXRJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJzdWJtZW51Iiwic2V0U3VibWVudSIsInJlbW92ZVN1Ym1lbnUiLCJpc1N1Ym1lbnUiLCJtZW51SXRlbSIsInN1Ym1lbnVJdGVtIiwiY29vcmRzIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwib3ZlckVkZ2UiXSwibWFwcGluZ3MiOiJBQUFBLElBQUFBLFNBQUEsQ0FDQUMsWUFBQUMsR0FDQSxJQUFBQyxFQUFBRCxFQUFBRSxPQUFBQyxRQUFBLG1CQUVBLEdBREFDLEtBQUFILE1BQUFHLEtBQUFILElBQUFJLFNBQUFKLElBQUFHLEtBQUFFLFlBQUFGLEtBQUFHLGdCQUNBTixFQUFBLE9BQ0FHLEtBQUFILElBQUFBLEVBRUFHLEtBQUFJLEtBQUFQLEVBQUFRLGNBQUEsd0JBQ0EsSUFBQUMsRUFBQVQsRUFBQVEsY0FBQSx1QkFDQSxJQUFBTCxLQUFBSSxPQUFBRSxFQUFBLE9BRUFWLEVBQUFXLGlCQUVBWCxFQUFBRSxPQUFBQyxRQUFBLHdCQUNBQyxLQUFBRyxlQUdBLElBQUFLLEVBQUFaLEVBQUFFLE9BQUFDLFFBQUEsd0JBQ0FTLEdBQUFSLEtBQUFTLG1CQUFBRCxFQUFBRixJQUVBWCxtQkFBQWEsRUFBQUYsR0FDQSxJQUFBSSxFQUFB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LEVBQUEwRixTQUNBdEYsS0FBQXVDLFdBQUF0QyxTQUFBbUYsSUFBQXBGLEtBQUE0RCxvQkFBQTVELEtBQUF1RixhQUVBdkYsS0FBQXVGLFlBQUEzRixFQUFBaUUsUUFHQWxFLHFCQUNBSyxLQUFBMEQsY0FBQSxFQUdBL0QsYUFDQUssS0FBQTBDLFNBQUE4QyxZQUFBLEtBQ0EsSUFBQTFCLEVBQUE5RCxLQUFBeUMsWUFBQSxFQUNBekMsS0FBQXlELGFBQUFLLEdBRUE5RCxLQUFBMEQsY0FBQSxHQUNBLElBQUExRCxLQUFBb0MsTUFHQXpDLFlBQ0E4RixjQUFBekYsS0FBQTBDLFVBR0EvQyxRQUNBSyxLQUFBdUMsV0FBQXpCLE1BQUFxRCxVQUFBLGtCQUNBbkUsS0FBQXlELGFBQUEsSUNsSkEsSUFBQWlDLFFBQUEsQ0FFQS9GLFlBQUFDLElBQ0FBLEVBQUEwRCxLQUFBLGNBQUF0RCxLQUFBMkYsV0FBQS9GLEVBQUFFLFNBQ0FGLEVBQUEwRCxLQUFBLGFBQUF0RCxLQUFBNEYsY0FBQWhHLEVBQUFFLFNBR0FILFdBQUFhLEdBQ0EsR0FBQVIsS0FBQTZGLFVBQUEsT0FHQSxHQURBN0YsS0FBQThGLFNBQUF0RixFQUFBVCxRQUFBLG1CQUNBQyxLQUFBOEYsU0FBQSxPQUVBLElBQUFDLEVBQUEvRixLQUFBOEYsU0FBQXpGLGNBQUEsWUFDQSxJQUFBMEYsRUFBQSxPQUVBLElBQUFDLEVBQUFELEVBQUFFLHdCQUNBQyxFQUFBNUUsU0FBQUMsZ0JBQUFDLGFBQUF3RSxFQUFBakMsS0FBQWdDLEVBQUFmLGFBQ0FlLEVBQUFqRixNQUFBaUQsS0FBQW1DLEVBQUEsRUFBQUEsRUFBQSxHQUFBLEtBQUEsR0FFQWxHLEtBQUE2RixXQUFBLEdBR0FsRyxjQUFBYSxHQUNBUixLQUFBNkYsV0FFQTdGLEtBQUE4RixTQUFBN0YsU0FBQU8sS0FFQVIsS0FBQTZGLFdBQUEiLCJmaWxlIjoibGlicy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgZHJvcGRvd24gPSB7XHJcbiAgICBoYW5kbGVFdmVudChldmVudCkge1xyXG4gICAgICAgIGxldCBib3ggPSBldmVudC50YXJnZXQuY2xvc2VzdCgnW2RhdGEtZHJvcGRvd25dJyk7XHJcbiAgICAgICAgaWYodGhpcy5ib3ggJiYgIXRoaXMuYm94LmNvbnRhaW5zKGJveCkgJiYgdGhpcy5pc0Ryb3Bkb3duKSB0aGlzLnNob3dEcm9wZG93bigpO1xyXG4gICAgICAgIGlmKCFib3gpIHJldHVybjtcclxuICAgICAgICB0aGlzLmJveCA9IGJveDtcclxuXHJcbiAgICAgICAgdGhpcy5saXN0ID0gYm94LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWRyb3Bkb3duLWxpc3RdJyk7XHJcbiAgICAgICAgbGV0IGJ0biA9IGJveC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1kcm9wZG93bi1idG5dJyk7XHJcbiAgICAgICAgaWYoIXRoaXMubGlzdCB8fCAhYnRuKSByZXR1cm47XHJcblxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIGlmKGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1kcm9wZG93bi1idG5dJykpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93RHJvcGRvd24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBlbGVtID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLWRyb3Bkb3duLWl0ZW1dJyk7XHJcbiAgICAgICAgaWYoZWxlbSkgdGhpcy5jaG9vc2VEcm9wZG93bkl0ZW0oZWxlbSwgYnRuKTtcclxuICAgIH0sXHJcbiAgICBjaG9vc2VEcm9wZG93bkl0ZW0oZWxlbSwgYnRuKSB7XHJcbiAgICAgICAgbGV0IGVsZW1DaGlsZCA9IGVsZW0uaW5uZXJIVE1MO1xyXG4gICAgICAgIGxldCBidG5DaGlsZCA9IGJ0bi5pbm5lckhUTUw7XHJcblxyXG4gICAgICAgIGVsZW0uaW5uZXJIVE1MID0gYnRuQ2hpbGQ7XHJcbiAgICAgICAgYnRuLmlubmVySFRNTCA9IGVsZW1DaGlsZDtcclxuICAgICAgICB0aGlzLnNob3dEcm9wZG93bigpO1xyXG4gICAgfSxcclxuICAgIHNob3dEcm9wZG93bigpIHtcclxuICAgICAgICB0aGlzLmlzRHJvcGRvd24gPSAocGFyc2VGbG9hdCh0aGlzLmxpc3Quc3R5bGUuaGVpZ2h0KSA9PSB0aGlzLmxpc3Quc2Nyb2xsSGVpZ2h0KTtcclxuICAgICAgICB0aGlzLmxpc3Quc3R5bGUuaGVpZ2h0ID0gKHRoaXMuaXNEcm9wZG93bikgPyAnJyA6IHRoaXMubGlzdC5zY3JvbGxIZWlnaHQgKyAncHgnO1xyXG4gICAgICAgIHRoaXMuaXNEcm9wZG93biA9ICF0aGlzLmlzRHJvcGRvd247XHJcbiAgICAgICAgdGhpcy5saXN0LmRhdGFzZXQuZHJvcGRvd25MaXN0ID0gdGhpcy5pc0Ryb3Bkb3duO1xyXG4gICAgfVxyXG59IiwibGV0IHNjcm9sbExpbmVXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xyXG5cclxuZnVuY3Rpb24gbWVudShidG4sIGJ0bkNsYXNzKSB7XHJcbiAgICBidG4ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC50b2dnbGUoYnRuQ2xhc3MpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoYnRuLmRhdGFzZXQuYm9keUNsYXNzKTtcclxuICAgIH1cclxufTsiLCJcclxuY2xhc3MgU2xpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKHNsaWRlciwgeyBwb2ludENsYXNzTmFtZSwgcG9pbnRzRWxlbSwgdGltZSwgYXJyb3dMZWZ0LCBhcnJvd1JpZ2h0IH0pIHsgLy90aGUgdGltZSBhcmd1bWVudCB0YWtlcyBhIG51bWJlciB2YWx1ZSBhcyBzZWNvbmRzXHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lID0gc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNsaWRlci1saW5lXScpO1xyXG4gICAgICAgIGlmICghdGhpcy5zbGlkZXJMaW5lKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS5jc3NUZXh0ID0gXCJ0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMHB4KTtcIlxyXG5cclxuICAgICAgICB0aGlzLnBvaW50c0VsZW0gPSBwb2ludHNFbGVtO1xyXG4gICAgICAgIHRoaXMucG9pbnRDbGFzc05hbWUgPSBwb2ludENsYXNzTmFtZSB8fCAncG9pbnRDbGFzc05hbWUnO1xyXG4gICAgICAgIHRoaXMucG9pbnROdW1iZXIgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmludGVydmFsO1xyXG4gICAgICAgIHRoaXMudGltZSA9IHRpbWU7XHJcblxyXG4gICAgICAgIHRoaXMuaXNQcmVzc2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5tb3ZlV2l0aFByZXNzZWRNb3VzZSA9IHRoaXMubW92ZVdpdGhQcmVzc2VkTW91c2UuYmluZCh0aGlzKTtcclxuXHJcbiAgICAgICAgaWYgKHBhcnNlSW50KHRpbWUpKSB0aGlzLnN0YXJ0VGltZXIoKTtcclxuXHJcbiAgICAgICAgc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpKTtcclxuICAgICAgICBzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpKTtcclxuICAgICAgICBzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlRXZlbnQuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLm9udHJhbnNpdGlvbmVuZCA9ICgpID0+IHsgdGhpcy5jb21wbGV0ZVRyYW5zaXRpb24oKSB9O1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2V0LmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZUV2ZW50KGV2ZW50KSB7XHJcblxyXG4gICAgICAgIGxldCBwb2ludCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1zbGlkZXItcG9pbnRdJyk7XHJcbiAgICAgICAgaWYgKHBvaW50ICYmIGV2ZW50LnR5cGUgPT0gXCJjbGlja1wiKSB7XHJcbiAgICAgICAgICAgIGlmICghcG9pbnQuY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMucG9pbnRDbGFzc05hbWUpKSBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvL3ByZXZlbnQgdGhlIHByZXNzZWQgbGluayBnb2luZyBpZiBpdCBpcyB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgICAgICBpZiAocG9pbnQuZGF0YXNldC5zbGlkZXJQb2ludCAtIDEgPT0gdGhpcy5wb2ludE51bWJlcikgcmV0dXJuOyAvL2lmIHRoZSBwcmVzc2VkIGJ1dHRvbiBpcyB0aGUgc2FtZSBvbmUgbGlrZSBpbiB0aGUgcHJldmlvdXMgdGltZSB0aGVuIHRvIHJldHVyblxyXG4gICAgICAgICAgICBpZiAodGhpcy50aW1lKSB7IC8vIGlmIHRoZSBwb2ludCBoYXZlIHByZXNzZWQgdGhlbiB0byBjYW5jZWwgdGhlIGN1cnJlbnQgdGltZXIgYW5kIHN0YXJ0IGl0IHVudGlsbCB0aGUgdHJhbnNpdGlvbiBlbmQgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BUaW1lcigpOyAvLyBzdG9wIHRoZSB0aW1lciBhbnl3YXlcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlUG9pbnRzKHBvaW50LmRhdGFzZXQuc2xpZGVyUG9pbnQgLSAxKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1zbGlkZXItbGluZV0nKSAmJiAhdGhpcy5pc1RyYW5zaXRpb24pIHtcclxuICAgICAgICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtb3VzZWRvd24nOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRXaXRoUHJlc3NlZE1vdXNlKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2RiY2xpY2snOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2V1cCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRXaXRoUHJlc3NlZE1vdXNlKGV2ZW50LmNsaWVudFgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ2EnKSkgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAvL2lmKGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1zbGlkZXItYXJyb3ddJykpIHRoaXMuYXJyb3dzKGV2ZW50LnRhcmdldCk7ICBcclxuICAgIH1cclxuICAgIC8qIGFycm93cyhlbGVtKSB7XHJcbiAgICAgICAgbGV0IG9mZnNldFdpZHRoID0gdGhpcy5zbGlkZXJMaW5lLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIGxldCBsZWZ0ID0gcGFyc2VJbnQodGhpcy5zbGlkZXJMaW5lLnN0eWxlLmxlZnQpO1xyXG4gICAgICAgIGxldCBhbW91bnQgPSAoZWxlbS5kYXRhc2V0LnNsaWRlckFycm93ID09ICdsZWZ0JykgPyBsZWZ0ICsgb2Zmc2V0V2lkdGggOiBsZWZ0IC0gb2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgYW1vdW50ID0gKGFtb3VudCA+IDApID8gMCA6XHJcbiAgICAgICAgLy8gaWYgdGhlIHJlc3QgcGFydCBvZiBzbGlkZXIgbGluZSBzbWFsbGVyIHRoYW4gMTBweCB0aGVuIG5vIGNoYW5nZXNcclxuICAgICAgICAodGhpcy5zbGlkZXJMaW5lLnNjcm9sbFdpZHRoICsgYW1vdW50IDwgMTApID8gYW1vdW50ICsgb2Zmc2V0V2lkdGggOiBhbW91bnQ7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLmxlZnQgPSBhbW91bnQgKyBcInB4XCI7XHJcbiAgICB9ICovXHJcblxyXG4gICAgbW92ZVNsaWRlcihpbmRleCkgeyAvLyBjaGFuZ2VzIChtb3ZlcykgdGhlIHNsaWRlciB0YXBlIChzbGlkZXIgbGluZSkgcG9zaXRpb25cclxuICAgICAgICBsZXQgbGVmdCA9IHRoaXMuc2xpZGVyTGluZS5zY3JvbGxXaWR0aCAvIHRoaXMuc2xpZGVyTGluZS5jaGlsZHJlbi5sZW5ndGggKiBpbmRleDtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7bGVmdH1weClgO1xyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZVBvaW50cyhpbmRleCkgeyAvLyBjaGFuZ2VzIGEgY2xhc3Mgb2YgdGhlIHByZXNzZWQgYnV0dG9uIChzbGlkZXIgcG9pbnQpIGFuZCBtb3ZlcyB0aGUgc2xpZGVyIHRhcGUgKHNsaWRlciBsaW5lKSAgXHJcbiAgICAgICAgaW5kZXggPSAoaW5kZXggPCAwKSA/IHRoaXMuc2xpZGVyTGluZS5jaGlsZHJlbi5sZW5ndGggLSAxIDpcclxuICAgICAgICAgICAgKGluZGV4ID4gdGhpcy5zbGlkZXJMaW5lLmNoaWxkcmVuLmxlbmd0aCAtIDEpID8gMCA6IGluZGV4O1xyXG4gICAgICAgIGlmICh0aGlzLnBvaW50c0VsZW0pIHtcclxuICAgICAgICAgICAgdGhpcy5wb2ludHNFbGVtLmNoaWxkcmVuW3RoaXMucG9pbnROdW1iZXJdLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5wb2ludENsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRzRWxlbS5jaGlsZHJlbltpbmRleF0uY2xhc3NMaXN0LmFkZCh0aGlzLnBvaW50Q2xhc3NOYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wb2ludE51bWJlciA9IGluZGV4O1xyXG4gICAgICAgIHRoaXMubW92ZVNsaWRlcihpbmRleCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhcnRXaXRoUHJlc3NlZE1vdXNlKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5pc1ByZXNzZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc3RhcnREaXN0YW5jZSA9IGV2ZW50LmNsaWVudFg7XHJcbiAgICAgICAgdGhpcy5zdG9wVGltZXIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0aWFsU2xpZGUgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnW2RhdGEtc2xpZGVyLWl0ZW1dJyk7IC8vZGVjaXNpb24gb2YgY3VycmVudGx5IGZvciBhIHNpbmdsZSB2aXNpYmxlIHNsaWRlIG9mIHRoZSBzbGlkZXJcclxuXHJcbiAgICAgICAgdGhpcy5pbml0aWFsVHJhbnNmb3JtID0gK2dldENvbXB1dGVkU3R5bGUodGhpcy5zbGlkZXJMaW5lKS50cmFuc2Zvcm0uc3BsaXQoJywnKVs0XTtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNpdGlvbiA9ICdpbml0aWFsJztcclxuXHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW92ZVdpdGhQcmVzc2VkTW91c2UpO1xyXG4gICAgfVxyXG4gICAgZW5kV2l0aFByZXNzZWRNb3VzZShjbGllbnRYKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzUHJlc3NlZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLmlzUHJlc3NlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2l0aW9uID0gJyc7XHJcblxyXG4gICAgICAgIGxldCBkaWZmT2ZEaXN0YW5jZSA9IGNsaWVudFggLSB0aGlzLnN0YXJ0RGlzdGFuY2U7XHJcbiAgICAgICAgaWYgKE1hdGguYWJzKGRpZmZPZkRpc3RhbmNlKSA8IHRoaXMuc2xpZGVyTGluZS5vZmZzZXRXaWR0aCAqIC4yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgke3RoaXMuaW5pdGlhbFRyYW5zZm9ybX1weClgO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlUG9pbnRzKChkaWZmT2ZEaXN0YW5jZSA8IDApID8gdGhpcy5wb2ludE51bWJlciArIDEgOiB0aGlzLnBvaW50TnVtYmVyIC0gMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5tb3ZlV2l0aFByZXNzZWRNb3VzZSk7XHJcbiAgICAgICAgdGhpcy5pc1RyYW5zaXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc3RhcnRUaW1lcigpO1xyXG4gICAgfVxyXG4gICAgbW92ZVdpdGhQcmVzc2VkTW91c2UoZXZlbnQpIHtcclxuICAgICAgICBsZXQgZGlmZk9mRGlzdGFuY2UgPSBldmVudC5jbGllbnRYIC0gdGhpcy5zdGFydERpc3RhbmNlO1xyXG5cclxuICAgICAgICBsZXQgc2hpZnQgPSB0aGlzLmluaXRpYWxUcmFuc2Zvcm0gKyBkaWZmT2ZEaXN0YW5jZTtcclxuICAgICAgICBsZXQgbWF4U2hpZnQgPSAtKHRoaXMuc2xpZGVyTGluZS5zY3JvbGxXaWR0aCAtIHRoaXMuc2xpZGVyTGluZS5jbGllbnRXaWR0aCk7XHJcbiAgICAgICAgc2hpZnQgPSAoc2hpZnQgPj0gMCkgPyAwIDpcclxuICAgICAgICAgICAgKHNoaWZ0IDw9IG1heFNoaWZ0KSA/IG1heFNoaWZ0IDogc2hpZnQ7XHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgke3NoaWZ0fXB4KWA7XHJcblxyXG4gICAgICAgIGxldCBjdXJyZW50RWxlbSA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNsaWRlckxpbmUuY29udGFpbnMoY3VycmVudEVsZW0pKSB0aGlzLmVuZFdpdGhQcmVzc2VkTW91c2UodGhpcy5wcmV2Q2xpZW50WCk7XHJcblxyXG4gICAgICAgIHRoaXMucHJldkNsaWVudFggPSBldmVudC5jbGllbnRYO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBsZXRlVHJhbnNpdGlvbigpIHtcclxuICAgICAgICB0aGlzLmlzVHJhbnNpdGlvbiA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0VGltZXIoKSB7XHJcbiAgICAgICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5wb2ludE51bWJlciArIDE7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlUG9pbnRzKGluZGV4KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuaXNUcmFuc2l0aW9uID0gdHJ1ZTtcclxuICAgICAgICB9LCB0aGlzLnRpbWUgKiAxMDAwKTtcclxuICAgIH1cclxuXHJcbiAgICBzdG9wVGltZXIoKSB7XHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoMHB4KWA7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VQb2ludHMoMCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vLyBQYXR0ZXJuIG9mIHRoZSBIVE1MIHNsaWRlcjpcclxuLy8gYmxvY2sgc2xpZGVyICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkZWZpbmVzIHRoZSB0b3RhbCB3aWR0aCBvZiB0aGUgc2xpZGVyJ3MgcGFnZSAoY29udGFpbmVyKVxyXG4vLyAgICAgYmxvY2sgc2xpZGVyLWNvbnRhaW5lciAgICAgICAgICAgIC8vIGRlZmluZXMgYSB3aWR0aCBvZiB0aGUgc2xpZGVyIFxyXG4vLyAgICAgICAgIGJsb2NrIFtkYXRhLXNsaWRlci1saW5lXSAgICAgICAgICAgICAvLyBkZWZpbmVzIHRoZSB0YXBlIG9mIHRoZSBzbGlkZXIsIHRoYXQgbW92ZXMgdGhyb3VnaFxyXG4vLyAgICAgICAgICAgICBibG9ja3MgW2RhdGEtc2xpZGVyLWl0ZW09J251bWJlciddICogblxyXG4vLyAgICAgICAgIGJsb2NrIHNsaWRlci1hcnJvd3MgICBcclxuLy8gICAgICAgICBibG9jayBzbGlkZXItcG9pbnRzXHJcbi8vICAgICAgICAgICAgIGJsb2NrcyBbZGF0YS1zbGlkZXItcG9pbnQ9J251bWJlciddICogblxyXG5cclxuXHJcblxyXG5cclxuLy90aGlzLnRyYW5zaXRpb25TdGFydFRpbWVyKCk7IC8vIHVzZSB0cmFuc2l0aW9uU3RhcnRUaW1lciBpbnN0ZWFkIHVzdWFsbCBzdGFydFRpbWVyIHRvIGNvbnNpZGVyIHRyYW5zaXRpb24gdGltZVxyXG5cclxuLy90aGlzLnNsaWRlckxpbmUub250cmFuc2l0aW9uZW5kID0gZmFsc2U7XHJcblxyXG4vLyB0cmFuc2l0aW9uU3RhcnRUaW1lcigpIHsgLy8gc3RhcnRzIHRoZSBuZXh0IHRpbWUgaW50ZXJ2YWwgYWZ0ZXIgdGhlIGN1cnJlbnQgdHJhbnNpdGlvbiBvbmx5XHJcbi8vICAgICBpZihwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUodGhpcy5zbGlkZXJMaW5lKS50cmFuc2l0aW9uRHVyYXRpb24pKSB7IC8vIGlmIHRoZXJlJ3Mgc29tZSBhbmltYXRpb25cclxuLy8gICAgICAgICB0aGlzLnNsaWRlckxpbmUub250cmFuc2l0aW9uZW5kID0gKCkgPT4ge1xyXG4vLyAgICAgICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTtcclxuLy8gICAgICAgICAgICAgdGhpcy5zbGlkZXJMaW5lLm9udHJhbnNpdGlvbmVuZCA9IGZhbHNlO1xyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgdGhpcy5zdGFydFRpbWVyKCk7XHJcbi8vICAgICB9XHJcbi8vIH1cclxuXHJcbiIsImxldCBzdWJtZW51ID0ge1xyXG5cclxuICAgIGhhbmRsZUV2ZW50KGV2ZW50KSB7XHJcbiAgICAgICAgaWYoZXZlbnQudHlwZSA9ICdtb3VzZW92ZXInKSB0aGlzLnNldFN1Ym1lbnUoZXZlbnQudGFyZ2V0KTtcclxuICAgICAgICBpZihldmVudC50eXBlID0gJ21vdXNlb3V0JykgdGhpcy5yZW1vdmVTdWJtZW51KGV2ZW50LnRhcmdldCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldFN1Ym1lbnUoZWxlbSkge1xyXG4gICAgICAgIGlmKHRoaXMuaXNTdWJtZW51KSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMubWVudUl0ZW0gPSBlbGVtLmNsb3Nlc3QoJ1tkYXRhLXN1Ym1lbnVdJyk7XHJcbiAgICAgICAgaWYoIXRoaXMubWVudUl0ZW0pIHJldHVybjtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgc3VibWVudUl0ZW0gPSB0aGlzLm1lbnVJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5zdWJtZW51Jyk7XHJcbiAgICAgICAgaWYoIXN1Ym1lbnVJdGVtKSByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBjb29yZHMgPSBzdWJtZW51SXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBsZXQgb3ZlckVkZ2UgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggLSAoY29vcmRzLmxlZnQgKyBzdWJtZW51SXRlbS5vZmZzZXRXaWR0aCk7XHJcbiAgICAgICAgc3VibWVudUl0ZW0uc3R5bGUubGVmdCA9IChvdmVyRWRnZSA8IDApID8gb3ZlckVkZ2UgLSAxNSArICdweCcgOiAnJztcclxuXHJcbiAgICAgICAgdGhpcy5pc1N1Ym1lbnUgPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcbiAgICByZW1vdmVTdWJtZW51KGVsZW0pIHtcclxuICAgICAgICBpZighdGhpcy5pc1N1Ym1lbnUpIHJldHVybjtcclxuICAgICAgICBcclxuICAgICAgICBpZighdGhpcy5tZW51SXRlbS5jb250YWlucyhlbGVtKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLmlzU3VibWVudSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxufSJdfQ==
